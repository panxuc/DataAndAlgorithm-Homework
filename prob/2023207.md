# 带限矩阵方程组求解

by  李锦朋

时间限制: 1000 ms

内存限制: 1500 KB

## 问题描述

考虑如下的带限矩阵方程组：

$$AX = Z$$

其中 $A\in R^{n\times n}$ 为带限的三对角或五对角矩阵，若为三对角矩阵则有以下形式：

$$A=\begin{bmatrix} b_1 & c_1 \\\ a_2 & b_2 & c_2 \\\ & \ddots & \ddots & \ddots \\\ & & \ddots & \ddots & \ddots \\\ & & & a_{n-1} & b_{n-1} & c_{n-1} \\\ & & & & a_n & b_n \end{bmatrix}$$

若为五对角矩阵则有以下形式：

$$A=\begin{bmatrix} c_1 & d_1 & e_1 \\\ b_2 & c_2 & d_2 & e_2 \\\ a_3 & b_3 & c_3 & d_3 & e_3 \\\ & a_4 & b_4 & c_4 & d_4 & e_4 \\\ & & \ddots & \ddots & \ddots & \ddots & \ddots \\\ & & & \ddots & \ddots & \ddots & \ddots & \ddots \\\ & & & & a_{n-2} & b_{n-2} & c_{n-2} & d_{n-2} & e_{n-2} \\\ & & & & & a_{n-1} & b_{n-1} & c_{n-1} & d_{n-1} \\\ & & & & & & a_n & b_n & c_n \end{bmatrix}$$

$Z=[z_1,z_2,\cdots,z_m]\in R^{n\times m}$ 由 $m$ 个列向量构成。

现在给定非奇异矩阵 $A$ 和矩阵 $Z$，求解矩阵 $X$。
 
## 输入格式

第 $1$ 行输入 $p$，表示矩阵 $A$ 中存在非零元素的对角线的条数， $p$为 $3$ 或 $5$。

第 $2$ 行输入 $n$ 和 $m$，表示矩阵 $A$ 的维数和矩阵 $Z$ 的维数。其中 $n$ 不超过 $10000$， $m$ 不超过 $500$。

第 $3$ 行到第 $p+2$ 行，按照从矩阵 $A$ 的最上方的对角线到最下方的对角线的顺序依次输入各对角线的元素值。

即对于三对角矩阵，第 $3$ 行输入 $c_1,c_2,\cdots,c_{n-1}$，第 $4$ 行输入 $b_1,b_2,\cdots,b_n$，第 $5$ 行输入 $a_2,\cdots,a_n$；

对于五对角矩阵， 第 $3$ 行输入 $e_1,e_2,\cdots,e_{n-2}$，第 $4$ 行输入 $d_1,d_2,\cdots,d_{n-1}$，第 $5$ 行输入 $c_1,c_2,\cdots,c_n$，第 $6$ 行输入 $b_2,b_3,\cdots,b_n$，第 $7$ 行输入 $a_3,a_4,\cdots,a_n$。

最后 $m$ 行每行输入 $n$ 个浮点数，为别为矩阵 $Z$ 的第 $m$ 列向量 $z_m$ 的 $n$ 个元素值，即

$$z_{1,1},\cdots,z_{1,n} \\\ \cdots \\\ z_{m,1},\cdots,z_{m,n}$$

## 输出格式

输出共 $m$ 行，每行为 $n$ 个浮点数，分别为矩阵 $X$ 的每一列的各个元素值，每个元素值结果四舍五入保留 $4$ 位小数。

## 输入样例

```
3
3 2
44 62 
44 43 30 
3 34 
27 63 53 
14 52 19
```

## 输出样例

```
-0.9846 1.5983 -0.0447 
0.7073 -0.3892 1.0744
```

## 提示

计算带限矩阵 $LU$ 分解后元素间的递推表达式。